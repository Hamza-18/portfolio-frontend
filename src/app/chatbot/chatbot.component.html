<div class="chatbot-container">
  <!-- Chat toggle button -->
  <button 
    class="chat-toggle-btn" 
    (click)="toggleChat()"
    [class.active]="isChatOpen"
    title="Chat with me">
    <i class="chat-icon" [class.open]="isChatOpen">💬</i>
  </button>

  <!-- Chat window -->
  <div class="chat-window" [class.open]="isChatOpen">
    <!-- Chat header -->
    <div class="chat-header">
      <h3>Portfolio Assistant</h3>
      <div class="chat-controls">
        <button 
          class="control-btn clear-btn" 
          (click)="clearChat()" 
          title="Clear chat">
          🗑️
        </button>
        <button 
          class="control-btn close-btn" 
          (click)="toggleChat()" 
          title="Close chat">
          ✕
        </button>
      </div>
    </div>

    <!-- Messages container -->
    <div class="messages-container" #messagesContainer>
      <div 
        *ngFor="let message of messages" 
        class="message" 
        [class.user-message]="message.isUser"
        [class.bot-message]="!message.isUser">
        
        <div class="message-content">
          <div class="message-text" [innerHTML]="message.text | nl2br"></div>
          <div class="message-time">{{ message.timestamp | date:'short' }}</div>
          <div 
            *ngIf="message.confidence !== undefined" 
            class="confidence-indicator"
            [class.high-confidence]="message.confidence >= 0.8"
            [class.medium-confidence]="message.confidence >= 0.5 && message.confidence < 0.8"
            [class.low-confidence]="message.confidence < 0.5">
            Confidence: {{ (message.confidence * 100) | number:'1.0-0' }}%
          </div>
        </div>
      </div>

      <!-- Loading indicator -->
      <div *ngIf="isLoading" class="message bot-message">
        <div class="message-content">
          <div class="typing-indicator">
            <span></span>
            <span></span>
            <span></span>
          </div>
        </div>
      </div>
    </div>

    <!-- Input container -->
    <div class="input-container">
      <div class="input-wrapper">
        <textarea 
          [(ngModel)]="currentMessage"
          (keypress)="onKeyPress($event)"
          placeholder="Ask me about my experience, projects, or skills..."
          class="message-input"
          rows="1"
          [disabled]="isLoading"></textarea>
        <button 
          (click)="sendMessage()" 
          class="send-btn"
          [disabled]="!currentMessage.trim() || isLoading"
          title="Send message">
          <span class="send-icon">➤</span>
        </button>
      </div>
    </div>
  </div>
</div>
